<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="org.css">
    <style>

    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
        //node(<a/>) Toggle
        function orgtoggle(e) {
            $('a').on('click', function() {
                $(this).nextAll().toggle();
            });            
        }

        //Build root node
        function first_Orgchart(e) {
            $('#tree').append(
                $('<ul/>')
                .append(
                    $('<li/>').append(
                        $('<ul/>')
                        .attr('id', e)
                    )
                )
            );
        }

        //Build root node children
        function second_Orgchart(e1, e2) {
            $('#' + e1).append(
                $('<li/>')
                .append(
                    $('<ul/>')
                    .attr('id', e2)
                )
            );
        }

        //Insert data into node
        function Info_Insert(e) {
            $('#' + e).parent().prepend(
                $('<a/>')
                .attr('href', '#')
            );
        }

        //show number= 01,02,...,09,10
        function NumFormat(e) {
            var num;
            if (e < 10 && e >= 0) {
                num = '0' + e;
            } else if (e > 10) {
                num = e;
            } else {
                alert('function NumFormat has some problem!!');
            }
            return num;
        }
        
        function OrgChart_DataTable(){
            var table = [{
                id: '00-00-00',
                name: ''
            }, {
                id: '00-01',
                name: ''
            }, {
                id: '00',
                name: ''
            }, {
                id: '00-01',
                name: ''
            }, {
                id: '00',
                name: ''
            }, {
                id: '00',
                name: ''
            }, {
                id: '00-00-01',
                name: ''
            }, {
                id: '00-00-00-00',
                name: ''
            }, {
                id: '00-00-00-00-00',
                name: ''
            }, {
                id: '00-00-00-00-01',
                name: ''
            }];
            
            return table;
        }
        
        function Refresh_OrgChart_DataTable(){
            var table = OrgChart_DataTable();            
            var tableRowCount = table.length;
            var boolcount = 0;
            var bool = true;
            var dataRepeat = [];
            var repeatCount = 0;
            var arrayDataID = [];
            
            for(var i = 0; i < tableRowCount; i++){
                dataRepeat[i] = [];
            }
            
            for(var i = 0; i < tableRowCount; i++){
                var str = table[i]['id'];
                var boolcount = 0;
                
                for(var j = 0; j < tableRowCount; j++){                   
                    if(str == table[j]['id']){
                        boolcount++;                        
                    }
                    if(boolcount == 2){
                        repeatCount++;
                        break;
                    }
                }       
            } 
            
            console.log(repeatCount);
            
            
            
            6546546
            
        }

        //BuildOrgChart
        function BuildOrgChart() {
            var table = OrgChart_DataTable();
            var tableRowCount = table.length;
            var count = 0;
            var numarray = [];
            var getInfo = [];
            var str_remove = '';                       

            //Declare 2's dimension array
            for (var i = 0; i < 10; i++) {
                numarray[i] = 0;
                getInfo[i] = [];
            }
            
            //Check DataTable hierarchy
            for (var i = 0; i < tableRowCount; i++) {
                var tablecount = table[i]['id'].split('-').length;                
                
                if (tablecount >= count) {
                    count = tablecount;
                }

                //OrgChart has 10 hierarchy
                switch (tablecount) {
                    case 1:
                        getInfo[0][numarray[0]] = table[i]['id'];
                        numarray[0]++;
                        break;
                    case 2:
                        getInfo[1][numarray[1]] = table[i]['id'];
                        numarray[1]++;
                        break;
                    case 3:
                        getInfo[2][numarray[2]] = table[i]['id'];
                        numarray[2]++;
                        break;
                    case 4:
                        getInfo[3][numarray[3]] = table[i]['id'];
                        numarray[3]++;
                        break;
                    case 5:
                        getInfo[4][numarray[4]] = table[i]['id'];
                        numarray[4]++;
                        break;
                    case 6:
                        getInfo[5][numarray[5]] = table[i]['id'];
                        numarray[5]++;
                        break;
                    case 7:
                        getInfo[6][numarray[6]] = table[i]['id'];
                        numarray[6]++;
                        break;
                    case 8:
                        getInfo[7][numarray[7]] = table[i]['id'];
                        numarray[7]++;
                        break;
                    case 9:
                        getInfo[8][numarray[8]] = table[i]['id'];
                        numarray[8]++;
                        break;
                    case 10:
                        getInfo[9][numarray[9]] = table[i]['id'];
                        numarray[9]++;
                        break;
                    default:
                        alert('Your hierarchy is more than 10!!');
                }
            }

            //Build root node
            for (var i = 0; i < getInfo[0].length; i++) {
                first_Orgchart(getInfo[0][i]);
            }

            //Build root node children
            for (var i = 1; i < 10; i++) {
                if (getInfo[i].length > 0) {
                    for (var j = 0; j < getInfo[i].length; j++) {
                        var array = getInfo[i][j].split('-');
                        var remove = array.pop();
                        second_Orgchart(array.join('-'), getInfo[i][j]);
                    }
                }
            }

            //Insert data into node
            for (var i = 0; i < table.length; i++) {
                Info_Insert(table[i]['id']);
            }

            //Remove overage element
            str_remove = $('ul:not(:has(*))');
            str_remove.remove();
        }

        $(document).ready(function() {            
            if(Refresh_OrgChart_DataTable()){
                BuildOrgChart();
                orgtoggle();   
            }            
        });
    </script>
</head>

<body>
    <div id="tree"></div>
</body>

</html>